---
import Base from "../components/Base.astro";
import Footer from "../components/footer.astro";
import type { BlogPostFrontmatter, BlogPost } from "../types";
import dayjs from "dayjs";
import updateLocale from "dayjs/plugin/updateLocale";
import "dayjs/locale/pt-br";
import BlogPostCard from "@/components/blog-post-card.astro";

dayjs.extend(updateLocale);
dayjs.locale("pt-br");

const posts = (await Astro.glob<BlogPostFrontmatter>("./blog/*.md"))
  .filter((post) => !post.frontmatter.draft)
  .sort(
    (a, b) =>
      new Date(b.frontmatter.pubDate).valueOf() -
      new Date(a.frontmatter.pubDate).valueOf(),
  ) as BlogPost[];

const TITLE = "Blog â€¢ matheusinit";
const DESCRIPTION =
  "Blog posts sobre desenvolvimento de software escrito por matheusinit";
---

<Base title={TITLE} description={DESCRIPTION}>
  <div class="mx-auto pt-6">
    <h1 class="mb-6 text-[32px] font-bold text-primary-foreground">Blog</h1>

    <div class="grid md:grid-cols-2 grid-cols-1 md:gap-6">
      {
        posts.map((p) => (
          <BlogPostCard
            title={p.frontmatter.title}
            description={p.frontmatter.description}
            date={p.frontmatter.pubDate}
          />
        ))
      }
    </div>
  </div>

  <Footer />
</Base>
